3.2.1结构

![](/assets/RCNN_struct.png)2.extract region proposals 方法：selective search

warped region ：归一化为相同大小的图片，送入CNN网络

3.CNN网络训练

3.1 预训练

如果做的目标定位系统是定位男人、女人、猫、狗这四类目标，那我们将fine tuning的神经网络中的最后一层_num_设置为5（4+1），加的这一类代表背景。

3.2背景获取

首先，提前对图片数据提前标定目标位置，对于每张图可能获得一个或更多的标定矩形框（x，y，w，h分别表示横坐标的最小值，纵坐标的最小值、矩形框宽度、矩形框长度）。

其次，通过Python selectivesearch库中的selectivesearch指令获得多个目标框（Proposals）（selectivesearch指令根据图片的颜色变化、纹理等将多个像素合并为多个选框）。

接着通过定义并计算出的IoU（目标框与标定框的重合程度，即IoU=重合面积/两个矩形所占的面积（其中一个矩形是标定框，另一个矩形是目标框））与阈值比较，若大于这个阈值则表示该目标框标出的是男人、女人、猫或狗四类中的一类，若小于这个阈值则表示该标定框标出的是背景

4.SVM classify region

Fine tuning 阶段将IoU大于0.5的目标框圈定的图片作为正样本，小于0.5的目标框圈定的图片作为负样本。而在对每一类目标分类的SVM训练阶段，我们将标定框圈定的图片作为正样本，IoU小于0.3的目标框圈定的图片作为负样本，其余目标框舍弃。

将图片用selectivesearch指令分为多个矩形选框，用SVM模型对这些选框区域进行分类，即判定该区域中是否包含目标，并将标签为1（即包含人脸的图片）记录下来

5 使用回归器精细修正候选框位置 （box regression）

NMS  非最大值抑制

